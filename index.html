<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <title>0xTimeToDrop</title>
</head>

<body>
    <div class="container bg-body rounded card p-5 animate__animated animate__fadeIn">
        <div class="row items">
            <h1> <img src="https://rarible.com/static/media/rarible-logo.8f9f7683.svg" alt="" srcset=""> <b class="dcb"
                    id="p_1">Rarible: калькулятор цены дропа </b></h1>
            <small class="gray" id="p_2">Цены могут быть указаны <i>примерно</i> в реальном времени</small>
            <br><br>
            <div class="col-sm-12">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="shadow p-3 mb-5 bg-body rounded text-center">
                            <h1 id="upload"> </h1>
                            <span class="badge bg-warning text-dark" id="p_3"><b>Загрузка работы</b></span>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="shadow p-3 mb-5 bg-body rounded text-center">
                            <h1 id="tax"> </h1>
                            <span class="badge bg-danger" id="p_4">Коммисия транзакции</span>
                        </div>
                    </div>
                    <div class="col-sm-12">
                        <div class="shadow p-3 mb-5 bg-body rounded text-center">
                            <h1 id="a_bet"> </h1>
                            <span class="badge bg-success" id="p_5">Коммисия за принятие ставки</span>
                        </div>
                    </div>
                </div>
            </div>
            <small class="text-center"><span id="p_7">Работает с помощью рук</span> <a target="_blank"
                    href="https://t.me/alexdow"
                    style="color: orange; font-weight: bold; text-decoration: none; font-style: italic;">@alexdow</a>
            </small>
        </div>
    </div>
    <div class="row" style="text-align: center;">
    </div>

    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0" crossorigin="anonymous">
    </script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.6.0/dist/umd/popper.min.js"
        integrity="sha384-KsvD1yqQ1/1+IA7gi3P0tyJcT3vR+NdBTt13hSJ2lnve8agRGXTTyNaBYmCR/Nwi" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.min.js"
        integrity="sha384-nsg8ua9HAw1y0W1btsyWgBklPnCUAFLuTMS2G72MMONqmOymq585AcH49TLBQObG" crossorigin="anonymous">
    </script>
    <style>
        @font-face {
            font-family: 'Cera Pro';
            src: url('CeraPro-Regular.eot');
            src: local('Cera Pro Regular'), local('CeraPro-Regular'),
                url('fonts/CeraPro-Regular.eot?#iefix') format('embedded-opentype'),
                url('fonts/CeraPro-Regular.woff') format('woff'),
                url('fonts/CeraPro-Regular.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        @font-face {
            font-family: 'Cera Pro';
            src: url('CeraPro-Medium.eot');
            src: local('Cera Pro Medium'), local('CeraPro-Medium'),
                url('fonts/CeraPro-Medium.eot?#iefix') format('embedded-opentype'),
                url('fonts/CeraPro-Medium.woff') format('woff'),
                url('fonts/CeraPro-Medium.ttf') format('truetype');
            font-weight: 500;
            font-style: normal;
        }

        @font-face {
            font-family: 'Cera Pro';
            src: url('CeraPro-Bold.eot');
            src: local('Cera Pro Bold'), local('CeraPro-Bold'),
                url('fonts/CeraPro-Bold.eot?#iefix') format('embedded-opentype'),
                url('fonts/CeraPro-Bold.woff') format('woff'),
                url('fonts/CeraPro-Bold.ttf') format('truetype');
            font-weight: bold;
            font-style: normal;
        }

        .gray {
            color: gray;
        }

        body {
            font-family: 'Cera Pro';
        }

        .btn {
            font-weight: bold;
            border-radius: 100px;
        }

        .thx {
            background-color: blue;
        }
    </style>
    <script>
        var apiKey = "A5MD57TYASQAGA5PDKXUZ4X95CINU87F1S"
        var urlPricesAPI = "https://api.etherscan.io/api?module=stats&action=ethprice&apikey=" + apiKey
        var gasFeesAPI = "https://api.etherscan.io/api?module=gastracker&action=gasoracle&apikey=" + apiKey

        var low = document.getElementById("upload")
        var tax = document.getElementById("tax")
        var apprBet = document.getElementById("a_bet")

        var p1 = document.getElementById("p_1")
        var p2 = document.getElementById("p_2")
        var p3 = document.getElementById("p_3")
        var p4 = document.getElementById("p_4")
        var p5 = document.getElementById("p_5")
        var p6 = document.getElementById("p_6")
        var p7 = document.getElementById("p_7")
        var p8 = document.getElementById("p_8")


        var price = []

        function getPrices() {
            return fetch(urlPricesAPI).then(response => {
                return response.json()
            });
        }

        const getNavigatorLanguage = () => {
            if (navigator.languages && navigator.languages.length) {
                return navigator.languages[0];
            } else {
                return navigator.userLanguage || navigator.language || navigator.browserLanguage || 'en';
            }
        }

        function getGasFees() {
            return fetch(gasFeesAPI).then(response => {
                return response.json()
            });
        }

        function gasToEthPrice(gweiNow) {
            return gweiNow / 1000000000;
        }

        function calculateFee(gwei, lim, ethUSD) {
            var ethPrice = gasToEthPrice(gwei)
            var summEtc = lim * ethPrice
            return summEtc * ethUSD
        }


        function updatePrices() {
            Promise.all([getPrices(), getGasFees()]).then(obj => {
                var price = obj[0]["result"]["ethusd"]
                var gasFeesAPI = obj[1]["result"]["SafeGasPrice"]

                let uploadGasLim = 294000
                let approve = 45306
                let approveBet = 354315

                var lets = low.innerHTML = Math.round(calculateFee(gasFeesAPI, uploadGasLim, price)) + "$"
                var bets = tax.innerHTML = Math.round(calculateFee(gasFeesAPI, approve, price)) + "$"
                var abr = apprBet.innerHTML = Math.round(calculateFee(gasFeesAPI, approveBet, price)) + "$"
            })
        }

        function instantGratification(fn, delay) {
            fn();
            setInterval(fn, delay);
        }

        instantGratification(updatePrices, 5000);

        if (getNavigatorLanguage() != "ru-RU") {
            p1.innerHTML = "Rarible: drop price calculator"
            p2.innerHTML = "Prices can be quoted in approximately real time"
            p3.innerText = "Minting price"
            p4.innerHTML = "Transaction fee"
            p5.innerHTML = "Accept Bid Fee"
            p6.innerHTML = "Support Author"
            p7.innerHTML = "Works with help of"
        }
    </script>
</body>

</html>